{%- comment -%}
Music player include placeholder.
{%- endcomment -%}

{%- if page.audio_id and page.audio_id != "" -%}
<div class="music-player-wrapper" data-audio-id="{{ page.audio_id }}">

    <!-- Optional: native audio tag kept, but hidden -->
    <audio id="bhakti-audio-player" preload="metadata" crossorigin="anonymous" style="display:none;">
        <source
                src="https://drive.google.com/file/d/{{ page.audio_id }}"
                type="audio/mpeg">
    </audio>

</div>
<script type="module">
    import initMusicPlayer from "/assets/js/music-player-module.js";

    const wrapper = document.querySelector('[data-audio-id="{{ page.audio_id }}"]');
    const audioSrc = "{{ '/assets/audio/' | relative_url }}{{ page.section }}/{{ page.audio_id }}.mp3";

    initMusicPlayer(wrapper, {
        mode: "single",
        loop: false,
        playlist: [
            {
                src: audioSrc,
                title: "{{ page.title | escape }}",
                sub: "{{ page.section | escape }}"
            }
        ],
        startIndex: 0
    });
</script>
{%- endif -%}
