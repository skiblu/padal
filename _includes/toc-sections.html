{% comment %}
  TOC for a single parent. Usage:
    {% include toc-sections.html parent_name="my-parent-id" %}

  Lists all files where page.section matches the given parent_name.
{% endcomment %}

{%- assign pid = include.parent_name | default: "" -%}
{%- if pid == "" -%}
  {%- comment -%} no parent_name supplied â€” render nothing {%- endcomment -%}
{%- else -%}
  {%- comment -%} collect all files where section matches parent_name {%- endcomment -%}
  {%- assign children = site.html_pages | where: "section", pid | sort: "nav_order" -%}

  {%- if children and children.size > 0 -%}
    <div class="row justify-content-center">
      <div class="m-3 col-md-8">
        <div class="card">
          <div class="card-body">
            <h2 class="card-title h3">Contents</h2>
            <div class="row g-3 mt-2">
              {%- for c in children -%}
                <div class="col-12 col-md-4">
                  <div class="card toc-card h-100">
                    <div class="card-body p-3 d-flex flex-column">
                      <h3 class="card-title h6 mb-1">
                        <a href="{{ c.url | relative_url }}" class="toc-link stretched-link">{{ c.title }}</a>
                      </h3>
                      {%- if c.excerpt -%}
                        <p class="card-text small mb-0 text-muted mt-auto">{{ c.excerpt | strip_html | truncate: 120 }}</p>
                      {%- endif -%}
                    </div>
                  </div>
                </div>
              {%- endfor -%}
            </div>
            <link rel="stylesheet" href="{{ '/assets/css/toc.css' | relative_url }}">
          </div>
        </div>
      </div>
    </div>
  {%- endif -%}
{%- endif -%}
