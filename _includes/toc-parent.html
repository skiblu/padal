{% comment %}
  TOC for a single parent. Usage:
    {% include toc-parent.html parent_name="my-parent-id" %}

  Finds the parent page by its "id" front-matter (or title as fallback) and lists:
  - a link to the parent page
  - links to children where page.section matches the parent (sorted by nav_order)

  Silent if parent_name missing or no matching page.
{% endcomment %}

{%- assign pid = include.parent_name | default: "" -%}
{%- if pid == "" -%}
  {%- comment -%} no parent_name supplied â€” render nothing {%- endcomment -%}
{%- else -%}
  {%- comment -%} try find parent by id, then fall back to title {%- endcomment -%}
  {%- assign parent = site.html_pages | where: "id", pid | first -%}
  {%- if parent == nil -%}
    {%- assign parent = site.html_pages | where: "title", pid | first -%}
  {%- endif -%}

  {%- if parent -%}
    <div class="row justify-content-center">
      <div class="m-3 col-md-8">
        <div class="card">
          <div class="card-body">
            <h2 class="card-title h3">Contents</h2>
            <ul>
              <li>
                {%- comment -%}
                  Single children collection: prefer section == parent.parent_id; if empty, fall back to section == parent.title.
                  Then sort by nav_order.
                {%- endcomment -%}
                {%- assign children = site.html_pages | where: "section", parent.parent_id -%}
                {%- if children == nil or children.size == 0 -%}
                  {%- assign children = site.html_pages | where: "section", parent.title -%}
                {%- endif -%}
                {%- assign children = children | sort: "nav_order" -%}
                {%- if children and children.size > 0 -%}
                  <!-- Render children in 3 responsive columns (col-md-4) -->
                  <div class="row g-2 mt-2">
                    {%- for c in children -%}
                      <div class="col-12 col-md-4">
                        <a href="{{ c.url | relative_url }}">{{ c.title }}</a>
                      </div>
                    {%- endfor -%}
                  </div>
                {%- endif -%}
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  {%- endif -%}
{%- endif -%}
